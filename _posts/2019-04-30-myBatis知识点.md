---
layout:     post
title:      myBatis知识点
subtitle:   myBatis知识点
date:       2019-04-30
author:     Qc
header-img: img/post-bg-myBatis.png
catalog: true
tags:
    - myBatis
    - sql
---

# #与$区别
~~~
id = "qc"
#{id}：防止sql注入（'qc'）
${id}：简单的字符串替换（qc）
~~~
# 单一入参
## 简单参数
~~~
#{随意参数}
~~~
### ${id}
需要在对应参数上添加注解
~~~
@Param("id")
~~~
或使用
~~~
${_parameter} 或 ${value}
~~~
## POJO对象
~~~
#{对象属性名}
~~~
# 多个入参
自动封装为Map类型
~~~
map.put("param1", id);
map.put("param1", name);
map.put("paramN", ...);
~~~
# Map遍历
~~~
<foreach open="" close="" collection="map" index="key" item="obj" separator="and">
  <if test="obj.value!=null and obj.value!=''">
    ${key} = #{obj.value}
  </if>
</foreach>
~~~
# List遍历
## 单一参数
~~~
parameterType="java.util.List"
~~~
~~~
<foreach collection="list" index="index" item="id" open="(" close=")" separator=",">
  #{id}
</foreach>
~~~
# 其他
## 参数验证
~~~
_parameter.containsKey('id')
~~~
返回布尔类型
## 代码复用
~~~
<sql id="model"></sql>
~~~
~~~
<select>
  <include refid="model"/>
</select>
~~~
## 分页处理
传入RowBounds对象
~~~
if (page > 0) {
    page--;
}
int offset = page * rows;
int limit = rows;
RowBounds rb = new RowBounds(offset, limit);
~~~
## 打印SQL
~~~
mybatis.configuration.log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
~~~
## 定义参数类型
### 方法一
mybatis.configuration.jdbc-type-for-null: 'null'
### 方法二
~~~
#{id, jdbcType=VARCHAR}
~~~
| JDBCType      | JavaType                        |
| ------------- | ------------------------------- |
| CHAR          | String                          |
| VARCHAR       | String                          |
| LONGVARCHAR   | String                          |
| NUMERIC       | java.math.BigDecimal            |
| DECIMAL       | java.math.BigDecimal            |
| BIT           | boolean                         |
| BOOLEAN       | boolean                         |
| TINYINT       | byte                            |
| SMALLINT      | short                           |
| INTEGER       | int                             |
| BIGINT        | long                            |
| REAL          | float                           |
| FLOAT         | double                          |
| DOUBLE        | double                          |
| BINARY        | byte[]                          |
| VARBINARY     | byte[]                          |
| LONGVARBINARY | byte[]                          |
| DATE          | java.sql.Date                   |
| TIME          | java.sql.Time                   |
| TIMESTAMP     | java.sql.Timestamp              |
| CLOB          | Clob                            |
| BLOB          | Blob                            |
| ARRAY         | Array                           |
| DISTINCT      | mapping of underlying type      |
| STRUCT        | Struct                          |
| REF           | Ref                             |
| DATALINK      | java.net.URL[color=red][/color] |
